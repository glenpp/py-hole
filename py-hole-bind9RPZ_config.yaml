---
# cachedir: /var/local/bindRPZ
# cacheprefix: bindRPZcache-
# cache_sane_age_days: 14   # after which this will fail
# cache_time_min: 3600   # 1 hour default
# cache_time_default: 43200   # 12 hours default
# cache_time_max: 604800  # 7 days default
# fetch_user: nobody
# fetch_group: nogroup
reloadzonecommand: [ 'rndc', 'reload', 'rpz.example.com' ]
# defaultresponse: CNAME .

# blacklists can be put into catgories - "default" will be used where no category is provided
# each category must have a rpz_file, reload_zone_command, rpz_template
categories:
  default:
    # this is used when no category is specified in a blacklist
    rpz_file: /etc/bind/db.rpz.example.com
    reload_zone_command: [ 'rndc', 'reload', 'rpz.example.com' ]
    rpz_template: |
      ; see http://www.zytrax.com/books/dns/ch9/rpz.html
      ; zone file rpz.example.com
      $TTL 2h ; default TTL
      $ORIGIN rpz.example.com.
      ; email address is never used
      @ SOA nonexistent.nodomain.none. dummy.nodomain.none. <SERIAL> 12h 15m 3w 2h
      ; name server is never accessed but out-of-zone
      ;         NS  nonexistant.nodomain.none
      NS  dnsserver.example.com.
      
      ;example.net CNAME .
      ;*.example.net CNAME .
      
      ; Automatic rules start
      ;
    # end of template
    #
    # Templates will have the following substitutions:
    #   <SERIAL> => automatically generated serial number

  malicious:
    rpz_file: /etc/bind/db.rpz-malicious.example.com
    reload_zone_command: [ 'rndc', 'reload', 'rpz-malicious.example.com' ]
    rpz_template: |
      ; see http://www.zytrax.com/books/dns/ch9/rpz.html
      ; zone file rpz-malicious.example.com
      $TTL 2h ; default TTL
      $ORIGIN rpz-malicious.example.com.
      ; email address is never used
      @ SOA nonexistent.nodomain.none. dummy.nodomain.none. <SERIAL> 12h 15m 3w 2h
      ; name server is never accessed but out-of-zone
      ;         NS  nonexistant.nodomain.none
      NS  dnsserver.example.com.
      
      ;example.net CNAME .
      ;*.example.net CNAME .
      
      ; Automatic rules start
      ;


# Blacklists
#
# For some options (at your own risk!) for blacklists to use take a look at these:
#   https://firebog.net/
#   https://github.com/hslatman/awesome-threat-intelligence
# Note: the moment we specify blacklists, the base key completely replaces defaults
blacklists:
  - url: https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts
    # StevenBlack
    # big agregated list for many sources
    # category: default
    format: hosts
    hostskey: 0.0.0.0
    # sanity checks
    sane_size_min: 1048576
    sane_size_max: 2097152

  - url: https://urlhaus.abuse.ch/downloads/rpz/
    # urlhaus.abuse.ch
    category: malicious
    # malware distribution
    format: rpz
    # sanity checks
    sane_size_min: 32768
    sane_size_max: 131072

#  - url: https://v.firebog.net/hosts/Easyprivacy.txt
#    format: raw
#    # sanity checks
#    sane_size_min: 32768
#    sane_size_max: 131072
#    cache_sane_age_days: 90

# currently we support formats of:
#   * raw
#       - considers anything after "#" as comments
#       - one hostname per line
#   * hosts
#       - considers anything after "#" as comments
#       - requires "hostskey" matching the IP at the start of the line (any other IPs are ignored)
#       - multiple hosts per line (typical hosts file with aliases)
#   * rpz
#       - considers anything after ";" as comments
#       - skips $TTL, SOA and NS lines
#       - assumes record looks up to "CNAME ."


exclusions:
  trackersimulator.org: true  # eff testing
  eviltracker.net: true # eff testing
  do-not-tracker.org: true  # eff testing
  stats.stackexchange.com: true # actually the forum about statistics!
# Note that "localhost" is always excluded t prevent conflicts

# we can also add our own local backlist
#localblacklist:
#  - evilhost.example.com  # going there does evil stuff

